# Исследование: выбор хранилища
Задачи: Выбрать хранилище для задачи.
Написать скрипт, который генерирует в хранилище данные.
Измерить скорость добавления и чтения данных

Было решено протестировать Mongo и Postgresql


## 1. Подготовка mongo и postgres хранилищ для работы
```
docker-compose up -d
```

## 2. Создание виртуальной среды

- Установите зависимости:
```
python -m venv venv
.\venv\Scripts\activate
pip install -r requirements.txt
```

## 3. Запуск тестов производительности хранилищ
```
python -m research.py
```

Хранилища будут заполнены аналогичными данными 

Загрузка 1 млн. записей в Postgresql заняла 68.5591 секунд, Mongo - 34.0977 сек. Преимущество за Mongo.

## 4. Тестирование обработки уже загруженных данных
Результаты выполнения тестов можно посмотреть в `selecting_results.csv`:

| Запрос                          | Mongo  | Postgresql |
|---------------------------------|--------|------------|
| Список всех лайков пользователя | 0.0047 | 22.5161    |
| Количество лайков фильма        | 0.0205 | 0.025      |
| Список закладок пользователя    | 0.0042 | 23.2713    |
| Средняя оценка фильма           | 0.0016 | 0.0235     |


По результатам теста имеем преимущество за Mongo, в особенности со сценариями на получение больших списков с условиями


## 5. Тестирование вставки данных

Результаты выполнения тестов можно посмотреть в `inserting_results.csv`:

| Запрос           | Mongo  | Postgresql |
|------------------|--------|------------|
| Вставка лайков   | 0.1067 | 0.196      |
| Вставка ревью    | 0.0982 | 0.219      |
| Вставка закладок | 0.0851 | 0.174      |

По результатам теста имеем преимущество за Mongo

## 6. Выводы
По результатам тестов выбираем Mongo как более быстрое хранилище для данных сценариев работы. 
Будем реализовывать отдельный сервис, с хранилищем Mongo, чтобы не смешивать в одном сервисе различные технологии хранилищ.

Тесты производились на ПК с характеристиками:
ЦП: Intel Core i7-9700k 3.60 GHz
ОЗУ: Kingston 2*16Гб 2.4ГГц
Память: Samsung Evo 970 1Тб
ОС: Windows 10 Pro
Ресурсы ограничивались средой виртуализации WSL 2, и Docker 20.10.17 контейнерами 8 CPU, 8 GB RAM для каждого из узлов.
